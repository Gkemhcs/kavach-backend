{
  "test_cases": [
    {
      "name": "successful_get_version_details",
      "description": "Successfully get detailed information for a specific version",
      "input": {
        "version_id": "abc12345"
      },
      "expected": {
        "success": true,
        "error": null,
        "secret_version_detail": {
          "id": "abc12345",
          "environment_id": "550e8400-e29b-41d4-a716-446655440000",
          "commit_message": "Add database and API credentials",
          "created_at": "2024-01-01T12:00:00Z",
          "secrets": [
            {
              "name": "DATABASE_URL",
              "value": "postgresql://user:pass@localhost:5432/db"
            },
            {
              "name": "API_KEY",
              "value": "sk-1234567890abcdef"
            }
          ]
        }
      },
      "mock_setup": {
        "secret_repo": [
          {
            "method": "GetSecretVersion",
            "return": {
              "secret_version": {
                "id": "abc12345",
                "environment_id": "550e8400-e29b-41d4-a716-446655440000",
                "commit_message": "Add database and API credentials",
                "created_at": "2024-01-01T12:00:00Z"
              },
              "error": null
            }
          },
          {
            "method": "GetSecretsForVersion",
            "return": {
              "secrets": [
                {
                  "id": "550e8400-e29b-41d4-a716-446655440001",
                  "name": "DATABASE_URL",
                  "value_encrypted": "postgresql://user:pass@localhost:5432/db"
                },
                {
                  "id": "550e8400-e29b-41d4-a716-446655440002",
                  "name": "API_KEY",
                  "value_encrypted": "sk-1234567890abcdef"
                }
              ],
              "error": null
            }
          }
        ]
      }
    },
    {
      "name": "version_not_found_error",
      "description": "Fail when version ID does not exist",
      "input": {
        "version_id": "nonexistent"
      },
      "expected": {
        "success": false,
        "error": "version not found"
      },
      "mock_setup": {
        "secret_repo": [
          {
            "method": "GetSecretVersion",
            "return": {
              "error": "sql: no rows in result set"
            }
          }
        ]
      }
    },
    {
      "name": "database_error_on_version_fetch",
      "description": "Fail when database error occurs during version fetch",
      "input": {
        "version_id": "abc12345"
      },
      "expected": {
        "success": false,
        "error": "failed to get secret version"
      },
      "mock_setup": {
        "secret_repo": [
          {
            "method": "GetSecretVersion",
            "return": {
              "error": "database connection failed"
            }
          }
        ]
      }
    },
    {
      "name": "database_error_on_secrets_fetch",
      "description": "Fail when database error occurs during secrets fetch",
      "input": {
        "version_id": "abc12345"
      },
      "expected": {
        "success": false,
        "error": "failed to get secrets for version"
      },
      "mock_setup": {
        "secret_repo": [
          {
            "method": "GetSecretVersion",
            "return": {
              "secret_version": {
                "id": "abc12345",
                "environment_id": "550e8400-e29b-41d4-a716-446655440000",
                "commit_message": "Add database and API credentials",
                "created_at": "2024-01-01T12:00:00Z"
              },
              "error": null
            }
          },
          {
            "method": "GetSecretsForVersion",
            "return": {
              "error": "database connection failed"
            }
          }
        ]
      }
    },
    {
      "name": "decryption_error",
      "description": "Fail when decryption of secret values fails",
      "input": {
        "version_id": "abc12345"
      },
      "expected": {
        "success": false,
        "error": "decryption failed"
      },
      "mock_setup": {
        "secret_repo": [
          {
            "method": "GetSecretVersion",
            "return": {
              "secret_version": {
                "id": "abc12345",
                "environment_id": "550e8400-e29b-41d4-a716-446655440000",
                "commit_message": "Add database and API credentials",
                "created_at": "2024-01-01T12:00:00Z"
              },
              "error": null
            }
          },
          {
            "method": "GetSecretsForVersion",
            "return": {
              "secrets": [
                {
                  "id": "550e8400-e29b-41d4-a716-446655440001",
                  "name": "DATABASE_URL",
                  "value_encrypted": "corrupted_encrypted_value"
                }
              ],
              "error": null
            }
          }
        ]
      }
    },
    {
      "name": "empty_version_id_error",
      "description": "Fail when version ID is empty",
      "input": {
        "version_id": ""
      },
      "expected": {
        "success": false,
        "error": "version ID is required"
      },
      "mock_setup": {}
    }
  ]
} 